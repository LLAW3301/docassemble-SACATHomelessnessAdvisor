# This is the main file for your application.
# This file should contain the mandatory blocks
# as well as other data that defines your application
---
# Include other parts of this interview as a list of files in this block
include:
  - SHA_questions.yml
  - SHA_agency_table.yml
---
# If we use objects we will declare them here.  Every application has
# an 'endpoint' object.  You may use other objects depending on your
# application's needs
objects:
  - endpoint: DADict
  - HAAqualifyingagencies: DAList
  - HAAabor_list: DAList
---
# Welcome screen should go here
mandatory: True
question: Welcome!
subquestion: |
  Welcome to our Homelessness Advisory Application. It is designed to assist in finding services which may be of assistance if you find yourself likely to be homeless. 
 

  ***Disclaimer:***   
  No guarantees are made that any individual service may accept your enquiry or provide services to you. It is a guide to selected services only and may not include all services provided.


  If you continue you accept these terms.
field: HAAeligible
buttons:
  - "I Accept": True
  - "I Do Not Accept": False
---
code: |
  HAAqualifyingagencies.there_are_any = True
---
code: |
  HAAabor_list.there_are_any = True
---
mandatory: True
code: |
  if HAAeligible == True:
    for HAAagency in HAA_agencylist.keys():
      if (HAA_agencylist[HAAagency].item('min_age') <= HAAage <= HAA_agencylist[HAAagency].item('max_age') and
      HAA_agencylist[HAAagency].item('gender').item(HAAgender) and
      (HAAabor == True or (HAAabor == False and HAA_agencylist[HAAagency].item('indigenous') == False)) and
      ((HAA_agencylist[HAAagency].item('families').item('singles') == True and HAAchnpreg == False) or (HAA_agencylist[HAAagency].item('families').item('family') == True and HAAchnpreg == True ))):
          HAAqualifyingagencies.append(HAAagency)
  
    HAAqualifyingagencies.gathered = True
---
mandatory: true
code: |
  for HAA_agency in HAAqualifyingagencies:
    if HAA_agencylist[HAA_agency].item('indigenous'):
      HAAabor_list.append(HAA_agency)
      HAA_agencylist[HAA_agency]['printed'] = True

  HAAabor_list.gathered = True
---
# Families
mandatory: True
code: |
  for HAA_agency in HAAqualifyingagencies:
    if HAA_agencylist(HAA_agency).item('printed') == False:
      if blabla bla
        HAAfamiles_list.append(HAA_agency)
        HAA_agencylist[HAA_agency]['printed'] = True
        
        
---
# Metadata about the app.  This isn't displayed anywhere but is useful
# as a record.
#metadata:
#  title: Homelessness Assistance Application
#  authors:
#    - name: Julianne Keefe
#    - name: Thomas Press
#    - name: Nicholas Siemelink
#  organisation:  Flinders University

---
mandatory: true
question: Final Report
subquestion:  |

  % if HAAeligible:
    % if HAApets:
  The following emergency housing agencies will not accept pets, it is advised you contact Safe Pets Safe Families as soon as possible to discuss housing for your pet.  
    
  **Safe Pets, Safe Families**
  
  PO Box 427, Christies Beach, 5165
  
  safepetssafefamilies@gmail.com
  
  0409818879
  
    % endif
  
  ### Agencies
  
  You may be eligible for the following agencies. We advise that you immediately make contact with them to attempt to arrange emergency housing.
  
    % if HAAabor:
  ### Agencies servicing only Aboriginal people
      % for HAAagency in HAAabor_list:
  **${ HAA_agencylist[HAAagency].item('service') }**  
  ${ HAA_agencylist[HAAagency].item('address') }     
  
  ${ HAA_agencylist[HAAagency].item('email') }
  
  ${ HAA_agencylist[HAAagency].item('phone') }
  
      % endfor
    % endif
  
  
    % if HAAchnpreg:
  ### Agencies servicing only families
      % for HAAagency in HAAqualifyingagencies:
        % if (HAA_agencylist[HAAagency].item('families').item('singles') == False and HAA_agencylist[HAAagency].item('indigenous') == False):
  **${ HAA_agencylist[HAAagency].item('service') }**  
  ${ HAA_agencylist[HAAagency].item('address') }     
  
  ${ HAA_agencylist[HAAagency].item('email') }
  
  ${ HAA_agencylist[HAAagency].item('phone') }
  
        % endif
      % endfor
    % endif
  
  
    % if HAAchnpreg == False:
  ### Agencies servicing only singles
      % for HAAagency in HAAqualifyingagencies:
        % if (HAA_agencylist[HAAagency].item('families').item('family') == False and HAA_agencylist[HAAagency].item('indigenous') == False): 
  **${ HAA_agencylist[HAAagency].item('service') }**  
  ${ HAA_agencylist[HAAagency].item('address') }     
  
  ${ HAA_agencylist[HAAagency].item('email') }
  
  ${ HAA_agencylist[HAAagency].item('phone') }
  
        % endif
      % endfor
    % endif
    
  
  ### All other Qualifying Agencies
    % for HAAagency in HAAqualifyingagencies:
      % if (HAA_agencylist[HAAagency].item('families').item('singles') == True and HAA_agencylist[HAAagency].item('families').item('family') == True and HAA_agencylist[HAAagency].item('indigenous') == False):
  **${ HAA_agencylist[HAAagency].item('service') }**  
  ${ HAA_agencylist[HAAagency].item('address') }     
  
  ${ HAA_agencylist[HAAagency].item('email') }
  
  ${ HAA_agencylist[HAAagency].item('phone') }
  
      % endif
    % endfor
  
  # Community housing options
  % endif
  
  % if HAAeligible == False:
  ### The disclaimer has not been understood and accepted. Please restart and review the information.
  % endif
buttons:
  - Exit: exit
  - Restart: restart
---
      
